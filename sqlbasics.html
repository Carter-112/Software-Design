<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SQL Basics - Learning Guide</title>
  <link rel="stylesheet" href="styles.css">
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8347349621527130" crossorigin="anonymous"></script>
  <!-- Fire/Lava Mouse Trail Effect -->
  <script src="mouse-trail.js"></script>
  <script src="solution-fix.js"></script>
  <script src="diagnostic.js"></script>
  <script src="external-link-handler.js"></script>
  <script src="navigation.js"></script>
</head>
<body>
  <header>
    <div class="navbar">
      <div class="dropdown">
        <button class="dropbtn">Navigation â–¼</button>
        <div class="dropdown-content">
          <a href="index.html">Home</a>
          <a href="singly.html">Singly</a>
          <a href="doubly.html">Doubly</a>
          <a href="arraylist.html">ArrayList</a>
          <a href="hashmap.html">HashMap</a>
          <a href="hashset.html">HashSet</a>
          <a href="bst.html">BST</a>
          <a href="lazybst.html">LazyBST</a>
          <a href="redblacktree.html">Red-Black Tree</a>
          <a href="streams.html">Streams & Lambdas</a>
          <a href="random.html">Random</a>
          <a href="javabasics.html">Java Basics</a>
          <a href="pythonbasics.html">Python Basics</a>
          <a href="webbasics.html">HTML/CSS/JS Basics</a>
          <a href="sqlbasics.html">SQL Basics</a>
        </div>
      </div>
    </div>
  </header>

  <!-- Page Content -->
  <div id="content">
    <h1>SQL Basics Learning Guide</h1>
    <p>Learn the fundamentals of SQL (Structured Query Language) for managing and querying relational databases.</p>

    <div class="section-navigation">
      <button onclick="toggleSection('sql-intro')">SQL Introduction</button>
      <button onclick="toggleSection('sql-select')">SELECT Queries</button>
      <button onclick="toggleSection('sql-crud')">CRUD Operations</button>
      <button onclick="toggleSection('sql-joins')">JOINs & Relationships</button>
      <button onclick="toggleSection('sql-advanced')">Advanced SQL</button>
      <button onclick="toggleSection('sql-security')">SQL Security</button>
      <button onclick="toggleSection('sql-practice-section')">SQL Practice Problems</button>
    </div>

    <!-- Section placeholders - will be filled with content later -->
    <div id="sql-intro" class="sql-section">
      <h2>Introduction to SQL</h2>
      <p>SQL (Structured Query Language) is a standard language for storing, manipulating, and retrieving data in relational database management systems. SQL allows you to create databases, tables, store data, and perform various operations on the stored data.</p>

      <h3>What is a Database?</h3>
      <p>A database is an organized collection of structured data. The most common type of database is a relational database, which stores data in tables with rows and columns. Other types include NoSQL databases, which use different data models.</p>

      <h3>Relational Database Concepts</h3>
      <ul>
        <li><strong>Tables</strong>: Data is organized into tables (like spreadsheets)</li>
        <li><strong>Rows</strong>: Each row (or record) contains data about a specific instance</li>
        <li><strong>Columns</strong>: Each column defines a specific attribute or property</li>
        <li><strong>Primary Keys</strong>: Unique identifiers for each row</li>
        <li><strong>Foreign Keys</strong>: References between tables, creating relationships</li>
        <li><strong>Indexes</strong>: Special lookup tables that improve query performance</li>
      </ul>

      <h3>Popular Database Management Systems</h3>
      <ul>
        <li><strong>MySQL</strong>: Open-source, widely used for web applications</li>
        <li><strong>PostgreSQL</strong>: Feature-rich, extensible open-source database</li>
        <li><strong>SQLite</strong>: Lightweight, serverless database engine</li>
        <li><strong>Microsoft SQL Server</strong>: Commercial database by Microsoft</li>
        <li><strong>Oracle Database</strong>: Commercial enterprise database system</li>
      </ul>

      <h3>Creating Database and Tables</h3>
      <p>Let's see how to create a database and tables using SQL:</p>

      <div class="code-container">
        <textarea class="code-area" rows="25" readonly>
-- Creating a new database
CREATE DATABASE school;

-- Using the created database
USE school;

-- Creating a table for students
CREATE TABLE students (
    student_id INT PRIMARY KEY AUTO_INCREMENT,
    first_name VARCHAR(50) NOT NULL,
    last_name VARCHAR(50) NOT NULL,
    date_of_birth DATE,
    email VARCHAR(100) UNIQUE,
    enrollment_date DATE DEFAULT CURRENT_DATE,
    active BOOLEAN DEFAULT TRUE
);

-- Creating a table for courses
CREATE TABLE courses (
    course_id INT PRIMARY KEY AUTO_INCREMENT,
    course_name VARCHAR(100) NOT NULL,
    department VARCHAR(50),
    credits INT CHECK (credits > 0),
    description TEXT
);

-- Creating a table for student enrollments (with foreign keys)
CREATE TABLE enrollments (
    enrollment_id INT PRIMARY KEY AUTO_INCREMENT,
    student_id INT,
    course_id INT,
    enrollment_date DATE,
    grade CHAR(1),
    FOREIGN KEY (student_id) REFERENCES students(student_id),
    FOREIGN KEY (course_id) REFERENCES courses(course_id)
);
        </textarea>
      </div>

      <h3>Data Types in SQL</h3>
      <p>SQL supports various data types for different kinds of data. While the specifics may vary between different database systems, here are common data types:</p>

      <table class="data-table">
        <tr>
          <th>Category</th>
          <th>Data Types</th>
          <th>Description</th>
        </tr>
        <tr>
          <td>Numeric</td>
          <td>INT, BIGINT, TINYINT, DECIMAL, FLOAT</td>
          <td>For storing whole or decimal numbers</td>
        </tr>
        <tr>
          <td>String</td>
          <td>CHAR, VARCHAR, TEXT</td>
          <td>For storing text data</td>
        </tr>
        <tr>
          <td>Date & Time</td>
          <td>DATE, TIME, DATETIME, TIMESTAMP</td>
          <td>For storing date and time values</td>
        </tr>
        <tr>
          <td>Boolean</td>
          <td>BOOLEAN, BIT</td>
          <td>For storing true/false values</td>
        </tr>
        <tr>
          <td>Binary</td>
          <td>BLOB, BINARY</td>
          <td>For storing binary data like files</td>
        </tr>
      </table>

      <h3>SQL Commands Categories</h3>
      <p>SQL commands can be categorized into several types based on their functions:</p>

      <ol>
        <li><strong>Data Definition Language (DDL)</strong>: Used to define data structures
          <ul>
            <li>CREATE: Create objects like databases, tables, etc.</li>
            <li>ALTER: Modify existing database objects</li>
            <li>DROP: Delete objects from the database</li>
            <li>TRUNCATE: Remove all records from a table</li>
          </ul>
        </li>
        <li><strong>Data Manipulation Language (DML)</strong>: Used to manipulate data
          <ul>
            <li>SELECT: Retrieve data from database</li>
            <li>INSERT: Add new records</li>
            <li>UPDATE: Modify existing records</li>
            <li>DELETE: Remove records</li>
          </ul>
        </li>
        <li><strong>Data Control Language (DCL)</strong>: Used for access control
          <ul>
            <li>GRANT: Give privileges to users</li>
            <li>REVOKE: Take away privileges</li>
          </ul>
        </li>
        <li><strong>Transaction Control Language (TCL)</strong>: Manage transactions
          <ul>
            <li>COMMIT: Save changes permanently</li>
            <li>ROLLBACK: Undo changes</li>
            <li>SAVEPOINT: Set points to rollback to</li>
          </ul>
        </li>
      </ol>

      <h3>Basic SQL Syntax Rules</h3>
      <ul>
        <li>SQL is not case-sensitive (SELECT is the same as select)</li>
        <li>SQL statements end with a semicolon (;)</li>
        <li>SQL comments start with -- (single line) or /* ... */ (multi-line)</li>
        <li>Table and column names can be enclosed in backticks (`) or square brackets ([]) depending on the database system</li>
        <li>String values are enclosed in single quotes (')</li>
      </ul>

      <div class="practice-container">
        <h3>Practice: SQL Introduction</h3>
        <p>Write SQL statements to create a table named <code>products</code> with the following columns: product_id (integer, primary key), product_name (varchar, not null), price (decimal), category (varchar), and in_stock (boolean).</p>
        <textarea id="sql-intro-practice" class="practice-area" rows="10" placeholder="Write your SQL code here..."></textarea>
        <button onclick="checkAnswer('sql-intro-practice')">Check Answer</button>
        <div id="sql-intro-practice-feedback" class="feedback"></div>
      </div>
    </div>

    <div id="sql-select" class="sql-section" style="display: none;">
      <h2>SELECT Queries</h2>
      <p>The SELECT statement is used to query data from a database, filtering and organizing results. It is one of the most commonly used SQL commands and is the foundation of data retrieval.</p>

      <h3>Basic SELECT Statement</h3>
      <p>The simplest form of a SELECT statement retrieves all rows and columns from a table:</p>

      <div class="code-container">
        <textarea class="code-area" rows="6" readonly>
-- Retrieve all columns from the students table
SELECT * FROM students;

-- Retrieve specific columns
SELECT first_name, last_name, email FROM students;
        </textarea>
      </div>

      <h3>Filtering Data with WHERE</h3>
      <p>The WHERE clause allows you to filter records based on specified conditions:</p>

      <div class="code-container">
        <textarea class="code-area" rows="20" readonly>
-- Students with a specific last name
SELECT * FROM students
WHERE last_name = 'Smith';

-- Students older than 20 years
SELECT first_name, last_name
FROM students
WHERE date_of_birth < '2003-01-01';

-- Multiple conditions with AND
SELECT * FROM students
WHERE date_of_birth > '2000-01-01' AND active = TRUE;

-- Multiple conditions with OR
SELECT * FROM students
WHERE last_name = 'Smith' OR last_name = 'Johnson';

-- Using BETWEEN for a range
SELECT * FROM students
WHERE date_of_birth BETWEEN '2000-01-01' AND '2005-12-31';

-- Using IN for multiple possible values
SELECT * FROM students
WHERE last_name IN ('Smith', 'Johnson', 'Williams');
        </textarea>
      </div>

      <h3>Sorting Results with ORDER BY</h3>
      <p>ORDER BY allows you to sort the result set in ascending (ASC) or descending (DESC) order:</p>

      <div class="code-container">
        <textarea class="code-area" rows="12" readonly>
-- Sort students by last name (ascending is default)
SELECT * FROM students
ORDER BY last_name;

-- Sort students by enrollment date (newest first)
SELECT * FROM students
ORDER BY enrollment_date DESC;

-- Multiple sort criteria
SELECT * FROM students
ORDER BY last_name ASC, first_name ASC;
        </textarea>
      </div>

      <h3>Limiting Results</h3>
      <p>You can limit the number of rows returned by a query:</p>

      <div class="code-container">
        <textarea class="code-area" rows="12" readonly>
-- MySQL, PostgreSQL, SQLite syntax
SELECT * FROM students
LIMIT 10;

-- SQL Server syntax
SELECT TOP 10 * FROM students;

-- Oracle syntax
SELECT * FROM students
WHERE ROWNUM <= 10;
        </textarea>
      </div>

      <h3>Using Wildcard Searches with LIKE</h3>
      <p>The LIKE operator is used for pattern matching with wildcards:</p>

      <div class="code-container">
        <textarea class="code-area" rows="16" readonly>
-- Names that start with 'J'
SELECT * FROM students
WHERE first_name LIKE 'J%';

-- Names that end with 'son'
SELECT * FROM students
WHERE last_name LIKE '%son';

-- Names that contain 'an' anywhere
SELECT * FROM students
WHERE first_name LIKE '%an%';

-- Names with exactly 5 characters (underscore represents a single character)
SELECT * FROM students
WHERE first_name LIKE '_____';
        </textarea>
      </div>

      <h3>Aggregating Data with GROUP BY</h3>
      <p>GROUP BY groups rows that have the same values in specified columns, often used with aggregate functions:</p>

      <div class="code-container">
        <textarea class="code-area" rows="24" readonly>
-- Count students in each department
SELECT department, COUNT(*) AS student_count
FROM students
GROUP BY department;

-- Average age by department
SELECT department, AVG(YEAR(CURRENT_DATE) - YEAR(date_of_birth)) AS avg_age
FROM students
GROUP BY department;

-- Common aggregate functions
SELECT
    COUNT(*) AS total_students,
    MIN(date_of_birth) AS oldest_student_dob,
    MAX(date_of_birth) AS youngest_student_dob,
    AVG(YEAR(CURRENT_DATE) - YEAR(date_of_birth)) AS avg_age,
    SUM(credits) AS total_credits
FROM students;

-- Filtering grouped data with HAVING
SELECT department, COUNT(*) AS student_count
FROM students
GROUP BY department
HAVING COUNT(*) > 10;
        </textarea>
      </div>

      <h3>Handling NULL Values</h3>
      <p>NULL represents a missing or unknown value. You need special operators to work with NULL values:</p>

      <div class="code-container">
        <textarea class="code-area" rows="12" readonly>
-- Find students with no email
SELECT * FROM students
WHERE email IS NULL;

-- Find students with email
SELECT * FROM students
WHERE email IS NOT NULL;

-- Using COALESCE to provide a default for NULL values
SELECT first_name, last_name, COALESCE(email, 'No email provided') AS contact
FROM students;
        </textarea>
      </div>

      <h3>DISTINCT Keyword for Unique Values</h3>
      <p>The DISTINCT keyword removes duplicate values from the result set:</p>

      <div class="code-container">
        <textarea class="code-area" rows="8" readonly>
-- Get unique last names
SELECT DISTINCT last_name FROM students;

-- Get unique department-grade combinations
SELECT DISTINCT department, grade FROM enrollments
JOIN students ON enrollments.student_id = students.student_id;
        </textarea>
      </div>

      <h3>Using Calculated Fields</h3>
      <p>You can perform calculations and transformations in your SELECT statement:</p>

      <div class="code-container">
        <textarea class="code-area" rows="16" readonly>
-- Concatenate first and last names
SELECT CONCAT(first_name, ' ', last_name) AS full_name
FROM students;

-- Calculate age
SELECT
    first_name,
    last_name,
    date_of_birth,
    YEAR(CURRENT_DATE) - YEAR(date_of_birth) AS approximate_age
FROM students;

-- Price with tax calculation
SELECT
    product_name,
    price,
    price * 1.08 AS price_with_tax
FROM products;
        </textarea>
      </div>

      <div class="practice-container">
        <h3>Practice: SELECT Queries</h3>
        <p>Write a SELECT query to find all products in the 'Electronics' category with a price greater than $100, sorted by price in descending order. Include the product_name, price, and in_stock columns in your results.</p>
        <textarea id="sql-select-practice" class="practice-area" rows="10" placeholder="Write your SQL code here..."></textarea>
        <button onclick="checkAnswer('sql-select-practice')">Check Answer</button>
        <div id="sql-select-practice-feedback" class="feedback"></div>
      </div>
    </div>

    <div id="sql-crud" class="sql-section" style="display: none;">
      <h2>CRUD Operations</h2>
      <p>CRUD stands for Create, Read, Update, and Delete - the four basic functions for managing data in database applications.</p>

      <h3>CREATE (INSERT) Operations</h3>
      <p>The INSERT statement is used to add new records to a table:</p>

      <div class="code-container">
        <textarea class="code-area" rows="20" readonly>
-- Basic INSERT statement
INSERT INTO students (first_name, last_name, email, date_of_birth)
VALUES ('John', 'Smith', 'john.smith@example.com', '2000-01-15');

-- INSERT multiple rows at once
INSERT INTO students (first_name, last_name, email, date_of_birth)
VALUES
    ('Emily', 'Johnson', 'emily.j@example.com', '2001-05-20'),
    ('Michael', 'Williams', 'michael.w@example.com', '1999-11-08'),
    ('Sarah', 'Brown', 'sarah.b@example.com', '2002-03-12');

-- INSERT with SELECT statement (inserting data from another table)
INSERT INTO inactive_students (student_id, first_name, last_name, email)
SELECT student_id, first_name, last_name, email
FROM students
WHERE active = FALSE;

-- INSERT IGNORE (MySQL syntax) - silently ignores errors
INSERT IGNORE INTO students (student_id, first_name, last_name, email)
VALUES (1, 'Duplicate', 'Student', 'duplicate@example.com');
        </textarea>
      </div>

      <h3>READ (SELECT) Operations</h3>
      <p>The SELECT statement is used to retrieve records from a table (covered in more detail in the SELECT Queries section):</p>

      <div class="code-container">
        <textarea class="code-area" rows="8" readonly>
-- Basic SELECT statement
SELECT * FROM students WHERE student_id = 101;

-- SELECT specific columns
SELECT first_name, last_name, email FROM students WHERE active = TRUE;
        </textarea>
      </div>

      <h3>UPDATE Operations</h3>
      <p>The UPDATE statement is used to modify existing records:</p>

      <div class="code-container">
        <textarea class="code-area" rows="22" readonly>
-- Basic UPDATE statement
UPDATE students
SET email = 'new.email@example.com'
WHERE student_id = 101;

-- Update multiple columns at once
UPDATE students
SET
    last_name = 'Johnson-Smith',
    enrollment_date = '2022-09-01',
    active = TRUE
WHERE student_id = 101;

-- Update multiple rows at once
UPDATE students
SET active = FALSE
WHERE enrollment_date < '2020-01-01';

-- Update with data from another table
UPDATE courses c
SET credits = s.recommended_credits
FROM subject_standards s
WHERE c.subject = s.subject_name;

-- Update with limit (MySQL syntax)
UPDATE students SET active = FALSE ORDER BY enrollment_date LIMIT 5;
        </textarea>
      </div>

      <h3>DELETE Operations</h3>
      <p>The DELETE statement is used to remove records from a table:</p>

      <div class="code-container">
        <textarea class="code-area" rows="20" readonly>
-- Basic DELETE statement
DELETE FROM students
WHERE student_id = 101;

-- Delete multiple rows based on a condition
DELETE FROM students
WHERE active = FALSE;

-- Delete with JOIN (MySQL syntax)
DELETE s
FROM students s
JOIN enrollments e ON s.student_id = e.student_id
WHERE e.grade = 'F';

-- Delete with subquery
DELETE FROM students
WHERE student_id IN (
    SELECT student_id
    FROM enrollments
    WHERE grade = 'F'
);

-- Delete with limit (MySQL syntax)
DELETE FROM inactive_students ORDER BY last_active_date LIMIT 10;
        </textarea>
      </div>

      <h3>TRUNCATE Operations</h3>
      <p>The TRUNCATE statement is used to delete all rows from a table more efficiently than DELETE:</p>

      <div class="code-container">
        <textarea class="code-area" rows="6" readonly>
-- TRUNCATE is faster than DELETE but removes all data
TRUNCATE TABLE old_records;

-- You cannot use WHERE clause with TRUNCATE
        </textarea>
      </div>

      <h3>Transaction Management</h3>
      <p>Transactions ensure that a series of SQL operations are executed as a single unit of work:</p>

      <div class="code-container">
        <textarea class="code-area" rows="18" readonly>
-- Start a transaction
BEGIN TRANSACTION;

-- Perform multiple operations that should be atomic
UPDATE accounts SET balance = balance - 100 WHERE account_id = 1;
UPDATE accounts SET balance = balance + 100 WHERE account_id = 2;

-- If everything is OK, commit the changes
COMMIT;

-- If there's a problem, roll back all changes
-- ROLLBACK;

-- Using savepoints for partial rollbacks
BEGIN TRANSACTION;
UPDATE products SET price = price * 1.05;
SAVEPOINT price_update;
DELETE FROM products WHERE stock = 0;
-- If we decide to keep the price update but not the deletion:
ROLLBACK TO SAVEPOINT price_update;
COMMIT;
        </textarea>
      </div>

      <div class="practice-container">
        <h3>Practice: CRUD Operations</h3>
        <p>Write SQL statements to:</p>
        <ol>
          <li>Insert a new product with name 'Smartphone', price 699.99, category 'Electronics', and in_stock TRUE.</li>
          <li>Update the price of all products in the 'Electronics' category to increase by 10%.</li>
          <li>Delete all products that are not in stock.</li>
        </ol>
        <textarea id="sql-crud-practice" class="practice-area" rows="15" placeholder="Write your SQL code here..."></textarea>
        <button onclick="checkAnswer('sql-crud-practice')">Check Answer</button>
        <div id="sql-crud-practice-feedback" class="feedback"></div>
      </div>
    </div>

    <!-- Add placeholder for SQL practice section -->
    <div id="sql-practice-section" style="display: none;">
      <h2>SQL Practice Problems</h2>
      <p>Practice is essential for mastering SQL. This section contains hands-on exercises to test and improve your SQL skills across various difficulty levels.</p>

      <div class="practice-navigation">
        <button onclick="showPracticeCategory('basic')">Basic SQL</button>
        <button onclick="showPracticeCategory('intermediate')">Intermediate SQL</button>
        <button onclick="showPracticeCategory('advanced')">Advanced SQL</button>
        <button onclick="showPracticeCategory('challenges')">SQL Challenges</button>
      </div>

      <div id="basic-practice" class="practice-category">
        <h3>Basic SQL Practice</h3>
        <p>These exercises cover SQL fundamentals like queries and basic data manipulation.</p>
        <ul class="practice-list">
          <li><a href="#" class="coming-soon">Basic SELECT Queries - Coming Soon</a></li>
          <li><a href="#" class="coming-soon">WHERE Clause Filtering - Coming Soon</a></li>
          <li><a href="#" class="coming-soon">Sorting with ORDER BY - Coming Soon</a></li>
          <li><a href="#" class="coming-soon">Simple GROUP BY - Coming Soon</a></li>
          <li><a href="#" class="coming-soon">INSERT Operations - Coming Soon</a></li>
          <li><a href="#" class="coming-soon">UPDATE Operations - Coming Soon</a></li>
          <li><a href="#" class="coming-soon">DELETE Operations - Coming Soon</a></li>
        </ul>
      </div>

      <div id="intermediate-practice" class="practice-category" style="display: none;">
        <h3>Intermediate SQL Practice</h3>
        <p>These exercises focus on joins, subqueries, and more complex operations.</p>
        <ul class="practice-list">
          <li><a href="#" class="coming-soon">Multi-Table JOINs - Coming Soon</a></li>
          <li><a href="#" class="coming-soon">WHERE Subqueries - Coming Soon</a></li>
          <li><a href="#" class="coming-soon">HAVING Clause - Coming Soon</a></li>
          <li><a href="#" class="coming-soon">CASE Expressions - Coming Soon</a></li>
          <li><a href="#" class="coming-soon">UNION Operations - Coming Soon</a></li>
          <li><a href="#" class="coming-soon">Self-JOIN Techniques - Coming Soon</a></li>
          <li><a href="#" class="coming-soon">Creating Views - Coming Soon</a></li>
        </ul>
      </div>

      <div id="advanced-practice" class="practice-category" style="display: none;">
        <h3>Advanced SQL Practice</h3>
        <p>These exercises cover advanced SQL concepts and optimization techniques.</p>
        <ul class="practice-list">
          <li><a href="#" class="coming-soon">Window Functions - Coming Soon</a></li>
          <li><a href="#" class="coming-soon">Common Table Expressions - Coming Soon</a></li>
          <li><a href="#" class="coming-soon">Recursive Queries - Coming Soon</a></li>
          <li><a href="#" class="coming-soon">PIVOT and Crosstab - Coming Soon</a></li>
          <li><a href="#" class="coming-soon">JSON Operations - Coming Soon</a></li>
          <li><a href="#" class="coming-soon">Transaction Management - Coming Soon</a></li>
          <li><a href="#" class="coming-soon">Query Optimization - Coming Soon</a></li>
        </ul>
      </div>

      <div id="challenges-practice" class="practice-category" style="display: none;">
        <h3>SQL Challenges</h3>
        <p>These are complex, real-world SQL challenges that test multiple concepts together.</p>
        <ul class="practice-list">
          <li><a href="#" class="coming-soon">Sales Analysis Challenge - Coming Soon</a></li>
          <li><a href="#" class="coming-soon">Employee Hierarchy Report - Coming Soon</a></li>
          <li><a href="#" class="coming-soon">Inventory Management Problem - Coming Soon</a></li>
          <li><a href="#" class="coming-soon">Performance Optimization Challenge - Coming Soon</a></li>
          <li><a href="#" class="coming-soon">Data Migration Task - Coming Soon</a></li>
        </ul>
      </div>

      <div id="sql-practice-problem-container" style="display: none;">
        <div class="practice-problem-header">
          <h3 id="sql-practice-title">Problem Title</h3>
          <span id="sql-practice-difficulty" class="difficulty-badge">Basic</span>
        </div>

        <p id="sql-practice-description">Problem description will appear here.</p>

        <div class="schema-container">
          <h4>Database Schema</h4>
          <div id="schema-diagram" class="schema-diagram">
            <!-- Schema diagram will be inserted here -->
          </div>
          <div class="tabs">
            <button class="tab-button active" onclick="switchTab('schema-tab')">Schema</button>
            <button class="tab-button" onclick="switchTab('sample-data-tab')">Sample Data</button>
            <button class="tab-button" onclick="switchTab('expected-output-tab')">Expected Output</button>
          </div>
          <div id="schema-tab" class="tab-content active">
            <pre id="sql-practice-schema" class="code-display"></pre>
          </div>
          <div id="sample-data-tab" class="tab-content">
            <pre id="sql-practice-sample-data" class="code-display"></pre>
          </div>
          <div id="expected-output-tab" class="tab-content">
            <pre id="sql-practice-expected" class="code-display"></pre>
          </div>
        </div>

        <div class="editor-container">
          <h4>Your Solution</h4>
          <textarea id="sql-practice-area" class="practice-area" rows="10" placeholder="Write your SQL query here..."></textarea>
          <div class="button-group">
            <button onclick="checkSqlSolution()" class="primary-button">Check Solution</button>
            <button onclick="showHint()" class="secondary-button">Hint</button>
            <button onclick="resetSolution()" class="secondary-button">Reset</button>
          </div>
        </div>

        <div id="sql-practice-feedback" class="feedback"></div>
        <div id="sql-practice-hint" class="hint-box" style="display: none;"></div>
      </div>
    </div>

    <div id="sql-joins" class="sql-section" style="display: none;">
      <h2>JOINs & Relationships</h2>
      <p>JOINs are used to combine rows from two or more tables based on a related column. They are essential for working with relational databases, allowing you to retrieve data from multiple tables in a single query.</p>

      <h3>Understanding Database Relationships</h3>
      <p>Before diving into JOINs, it's important to understand the types of relationships in relational databases:</p>

      <ul>
        <li><strong>One-to-One (1:1)</strong>: Each record in Table A relates to exactly one record in Table B (e.g., a person and their social security number)</li>
        <li><strong>One-to-Many (1:N)</strong>: Each record in Table A relates to multiple records in Table B (e.g., a department has many employees)</li>
        <li><strong>Many-to-Many (N:M)</strong>: Multiple records in Table A relate to multiple records in Table B (e.g., students and courses - implemented using a junction table)</li>
      </ul>

      <p>Relationships are typically implemented using primary keys and foreign keys:</p>
      <div class="code-container">
        <textarea class="code-area" rows="20" readonly>
-- Example of creating related tables

-- Departments table (parent)
CREATE TABLE departments (
    dept_id INT PRIMARY KEY,
    dept_name VARCHAR(100) NOT NULL,
    location VARCHAR(100)
);

-- Employees table (child) with foreign key
CREATE TABLE employees (
    emp_id INT PRIMARY KEY,
    first_name VARCHAR(50) NOT NULL,
    last_name VARCHAR(50) NOT NULL,
    dept_id INT,
    hire_date DATE,
    salary DECIMAL(10, 2),
    FOREIGN KEY (dept_id) REFERENCES departments(dept_id)
);

-- Example of a many-to-many relationship with a junction table
CREATE TABLE students (
    student_id INT PRIMARY KEY,
    student_name VARCHAR(100) NOT NULL
);

CREATE TABLE courses (
    course_id INT PRIMARY KEY,
    course_name VARCHAR(100) NOT NULL
);

-- Junction table
CREATE TABLE enrollments (
    student_id INT,
    course_id INT,
    enrollment_date DATE,
    grade VARCHAR(2),
    PRIMARY KEY (student_id, course_id),
    FOREIGN KEY (student_id) REFERENCES students(student_id),
    FOREIGN KEY (course_id) REFERENCES courses(course_id)
);
        </textarea>
      </div>

      <h3>Types of SQL JOINs</h3>
      <p>SQL supports several types of JOINs that let you combine data from multiple tables in different ways:</p>

      <h4>1. INNER JOIN</h4>
      <p>Returns records that have matching values in both tables. This is the most common type of JOIN.</p>

      <div class="code-container">
        <textarea class="code-area" rows="15" readonly>
-- INNER JOIN syntax
SELECT columns
FROM table1
INNER JOIN table2 ON table1.column = table2.column;

-- Example: Get all employees with their department information
SELECT e.emp_id, e.first_name, e.last_name, d.dept_name
FROM employees e
INNER JOIN departments d ON e.dept_id = d.dept_id;

-- Note: Only employees who have a matching department will appear
-- Employees without a department and departments without employees are excluded
        </textarea>
      </div>

      <div style="text-align: center; margin: 20px 0;">
        <img src="https://www.codeproject.com/KB/database/Visual_SQL_Joins/INNER_JOIN.png" alt="INNER JOIN Venn Diagram" style="max-width: 80%; height: auto; border-radius: 5px;">
      </div>

      <h4>2. LEFT JOIN (or LEFT OUTER JOIN)</h4>
      <p>Returns all records from the left table and the matched records from the right table. If no match is found, NULL values are returned for columns from the right table.</p>

      <div class="code-container">
        <textarea class="code-area" rows="15" readonly>
-- LEFT JOIN syntax
SELECT columns
FROM table1
LEFT JOIN table2 ON table1.column = table2.column;

-- Example: Get all employees with their department information, including employees without departments
SELECT e.emp_id, e.first_name, e.last_name, d.dept_name
FROM employees e
LEFT JOIN departments d ON e.dept_id = d.dept_id;

-- Employees without a department will have NULL for dept_name
        </textarea>
      </div>

      <div style="text-align: center; margin: 20px 0;">
        <img src="https://www.codeproject.com/KB/database/Visual_SQL_Joins/LEFT_JOIN.png" alt="LEFT JOIN Venn Diagram" style="max-width: 80%; height: auto; border-radius: 5px;">
      </div>

      <h4>3. RIGHT JOIN (or RIGHT OUTER JOIN)</h4>
      <p>Returns all records from the right table and the matched records from the left table. If no match is found, NULL values are returned for columns from the left table.</p>

      <div class="code-container">
        <textarea class="code-area" rows="15" readonly>
-- RIGHT JOIN syntax
SELECT columns
FROM table1
RIGHT JOIN table2 ON table1.column = table2.column;

-- Example: Get all departments with their employee information, including departments without employees
SELECT e.emp_id, e.first_name, e.last_name, d.dept_name
FROM employees e
RIGHT JOIN departments d ON e.dept_id = d.dept_id;

-- Departments without employees will have NULL for employee columns
        </textarea>
      </div>

      <div style="text-align: center; margin: 20px 0;">
        <img src="https://www.codeproject.com/KB/database/Visual_SQL_Joins/RIGHT_JOIN.png" alt="RIGHT JOIN Venn Diagram" style="max-width: 80%; height: auto; border-radius: 5px;">
      </div>

      <h4>4. FULL JOIN (or FULL OUTER JOIN)</h4>
      <p>Returns all records when there is a match in either the left or right table. If no match is found, NULL values are returned for columns from the table without a match.</p>
      <p><em>Note: Not all database systems support FULL JOIN (e.g., MySQL does not directly support it).</em></p>

      <div class="code-container">
        <textarea class="code-area" rows="15" readonly>
-- FULL JOIN syntax
SELECT columns
FROM table1
FULL JOIN table2 ON table1.column = table2.column;

-- Example: Get all employees and all departments, regardless of whether they match
SELECT e.emp_id, e.first_name, e.last_name, d.dept_name
FROM employees e
FULL JOIN departments d ON e.dept_id = d.dept_id;

-- MySQL alternative (using UNION of LEFT JOIN and RIGHT JOIN)
SELECT e.emp_id, e.first_name, e.last_name, d.dept_name
FROM employees e
LEFT JOIN departments d ON e.dept_id = d.dept_id
UNION
SELECT e.emp_id, e.first_name, e.last_name, d.dept_name
FROM employees e
RIGHT JOIN departments d ON e.dept_id = d.dept_id
WHERE e.emp_id IS NULL;
        </textarea>
      </div>

      <div style="text-align: center; margin: 20px 0;">
        <img src="https://www.codeproject.com/KB/database/Visual_SQL_Joins/FULL_OUTER_JOIN.png" alt="FULL JOIN Venn Diagram" style="max-width: 80%; height: auto; border-radius: 5px;">
      </div>

      <h4>5. CROSS JOIN</h4>
      <p>Returns the Cartesian product of both tables (every row from the first table combined with every row from the second table). No ON clause is used.</p>

      <div class="code-container">
        <textarea class="code-area" rows="10" readonly>
-- CROSS JOIN syntax
SELECT columns
FROM table1
CROSS JOIN table2;

-- Example: Generate all possible combinations of departments and job titles
SELECT d.dept_name, j.job_title
FROM departments d
CROSS JOIN job_titles j;
        </textarea>
      </div>

      <h3>Self-JOIN</h3>
      <p>A self-JOIN is a regular join, but the table is joined with itself. This is useful for querying hierarchical data or comparing rows within the same table.</p>

      <div class="code-container">
        <textarea class="code-area" rows="20" readonly>
-- Example: Employee-Manager relationship (employees table with manager_id referencing emp_id)
CREATE TABLE employees (
    emp_id INT PRIMARY KEY,
    first_name VARCHAR(50),
    last_name VARCHAR(50),
    manager_id INT,
    FOREIGN KEY (manager_id) REFERENCES employees(emp_id)
);

-- Find all employees with their manager's name
SELECT e.emp_id,
       e.first_name || ' ' || e.last_name AS employee_name,
       m.first_name || ' ' || m.last_name AS manager_name
FROM employees e
LEFT JOIN employees m ON e.manager_id = m.emp_id;

-- Find all employees who are managers
SELECT DISTINCT m.emp_id, m.first_name, m.last_name
FROM employees e
JOIN employees m ON e.manager_id = m.emp_id;
        </textarea>
      </div>

      <h3>Natural JOIN</h3>
      <p>A NATURAL JOIN joins tables based on all columns with the same name. It's generally not recommended because it can lead to unexpected results if column names change.</p>

      <div class="code-container">
        <textarea class="code-area" rows="8" readonly>
-- NATURAL JOIN syntax
SELECT columns
FROM table1
NATURAL JOIN table2;

-- Example: Join departments and locations on any common column names
SELECT dept_name, location_city FROM departments NATURAL JOIN locations;
        </textarea>
      </div>

      <h3>JOIN Performance Considerations</h3>
      <p>JOINs are powerful but can impact query performance, especially with large tables. Here are some best practices:</p>

      <ul>
        <li><strong>Use Indexes</strong>: Ensure the columns used in JOIN conditions are indexed</li>
        <li><strong>Limit Joined Data</strong>: Only select the columns you need</li>
        <li><strong>Filter Early</strong>: Use WHERE clauses before JOINs when possible</li>
        <li><strong>Avoid CROSS JOINs</strong> on large tables as they produce very large result sets</li>
        <li><strong>Choose the Right JOIN Type</strong> for your specific use case</li>
      </ul>

      <div class="practice-container">
        <h3>Practice: JOINs and Relationships</h3>
        <p>Given tables for products, categories, and orders, write a query to find the total sales amount for each product category.</p>
        <textarea id="sql-joins-practice" class="practice-area" rows="15" placeholder="Write your SQL query here..."></textarea>
        <button onclick="checkAnswer('sql-joins-practice')">Check Answer</button>
        <div id="sql-joins-practice-feedback" class="feedback"></div>
      </div>

      <div class="practice-container">
        <h3>Practice: Self-JOIN</h3>
        <p>Using an employees table with a manager_id column, write a query to display each employee's name along with their manager's name.</p>
        <textarea id="sql-self-join-practice" class="practice-area" rows="15" placeholder="Write your SQL query here..."></textarea>
        <button onclick="checkAnswer('sql-self-join-practice')">Check Answer</button>
        <div id="sql-self-join-practice-feedback" class="feedback"></div>
      </div>
    </div>

    <div id="sql-advanced" class="sql-section" style="display: none;">
      <h2>Advanced SQL</h2>
      <p>Advanced SQL features include subqueries, views, stored procedures, triggers, and transactions. These features allow you to create more sophisticated database operations and enhance your database's functionality.</p>

      <h3>Subqueries</h3>
      <p>A subquery (inner query/nested query) is a query nested within another query. Subqueries can return data that will be used in the main query as a condition to further restrict the data to be retrieved.</p>

      <h4>Types of Subqueries</h4>

      <div class="code-container">
        <textarea class="code-area" rows="30" readonly>
-- 1. Subquery in SELECT clause
SELECT
    employee_name,
    salary,
    (SELECT AVG(salary) FROM employees) as company_avg_salary,
    salary - (SELECT AVG(salary) FROM employees) as difference_from_avg
FROM
    employees;

-- 2. Subquery in FROM clause (derived table)
SELECT
    dept_name,
    avg_salary
FROM
    (SELECT
        d.dept_name,
        AVG(e.salary) as avg_salary
     FROM
        employees e
     JOIN
        departments d ON e.dept_id = d.dept_id
     GROUP BY
        d.dept_name) as dept_salaries
WHERE
    avg_salary > 50000;

-- 3. Subquery in WHERE clause
-- Find employees who earn more than the average salary
SELECT
    employee_id,
    first_name,
    last_name,
    salary
FROM
    employees
WHERE
    salary > (SELECT AVG(salary) FROM employees);

-- 4. Correlated subquery (inner query refers to outer query)
-- Find employees who earn the highest salary in their department
SELECT
    e.employee_id,
    e.first_name,
    e.last_name,
    e.dept_id,
    e.salary
FROM
    employees e
WHERE
    e.salary = (
        SELECT MAX(salary)
        FROM employees
        WHERE dept_id = e.dept_id
    );
        </textarea>
      </div>

      <p>Subqueries can be used with comparison operators (<code>=, >, <, >=, <=, <>)</code> and logical operators (<code>IN, NOT IN, EXISTS, NOT EXISTS, ALL, ANY</code>):</p>

      <div class="code-container">
        <textarea class="code-area" rows="30" readonly>
-- IN operator with subquery
-- Find employees who work in departments located in 'New York'
SELECT
    employee_id,
    first_name,
    last_name
FROM
    employees
WHERE
    dept_id IN (
        SELECT dept_id
        FROM departments
        WHERE location = 'New York'
    );

-- EXISTS operator with subquery
-- Find departments that have at least one employee
SELECT
    dept_id,
    dept_name
FROM
    departments d
WHERE
    EXISTS (
        SELECT 1
        FROM employees e
        WHERE e.dept_id = d.dept_id
    );

-- ANY operator with subquery
-- Find employees who earn more than any employee in the IT department
SELECT
    employee_id,
    first_name,
    last_name,
    salary
FROM
    employees
WHERE
    salary > ANY (
        SELECT salary
        FROM employees
        JOIN departments ON employees.dept_id = departments.dept_id
        WHERE departments.dept_name = 'IT'
    );

-- ALL operator with subquery
-- Find employees who earn more than all employees in the IT department
SELECT
    employee_id,
    first_name,
    last_name,
    salary
FROM
    employees
WHERE
    salary > ALL (
        SELECT salary
        FROM employees
        JOIN departments ON employees.dept_id = departments.dept_id
        WHERE departments.dept_name = 'IT'
    );
        </textarea>
      </div>

      <h3>Common Table Expressions (CTEs)</h3>
      <p>CTEs provide a way to write auxiliary statements for use in a larger query. They are similar to derived tables but more readable.</p>

      <div class="code-container">
        <textarea class="code-area" rows="25" readonly>
-- Basic CTE syntax
WITH cte_name AS (
    SELECT column1, column2, ...
    FROM table
    WHERE conditions
)
SELECT * FROM cte_name;

-- Example: Find departments with above-average salaries
WITH dept_avg_salary AS (
    SELECT
        d.dept_id,
        d.dept_name,
        AVG(e.salary) as avg_salary
    FROM
        employees e
    JOIN
        departments d ON e.dept_id = d.dept_id
    GROUP BY
        d.dept_id, d.dept_name
),
company_avg AS (
    SELECT AVG(salary) as overall_avg
    FROM employees
)
SELECT
    d.dept_id,
    d.dept_name,
    d.avg_salary,
    c.overall_avg,
    d.avg_salary - c.overall_avg as difference
FROM
    dept_avg_salary d, company_avg c
WHERE
    d.avg_salary > c.overall_avg
ORDER BY
    difference DESC;
        </textarea>
      </div>

      <h4>Recursive CTEs</h4>
      <p>Recursive CTEs are useful for querying hierarchical data, such as organizational structures or bill of materials.</p>

      <div class="code-container">
        <textarea class="code-area" rows="30" readonly>
-- Employee hierarchy example (manager-subordinate relationship)
WITH RECURSIVE employee_hierarchy AS (
    -- Base case: employees with no manager (top level)
    SELECT
        employee_id,
        first_name,
        last_name,
        manager_id,
        0 as level,
        CAST(first_name || ' ' || last_name as VARCHAR(1000)) as hierarchy_path
    FROM
        employees
    WHERE
        manager_id IS NULL

    UNION ALL

    -- Recursive case: employees with managers
    SELECT
        e.employee_id,
        e.first_name,
        e.last_name,
        e.manager_id,
        eh.level + 1,
        CAST(eh.hierarchy_path || ' > ' || e.first_name || ' ' || e.last_name as VARCHAR(1000))
    FROM
        employees e
    JOIN
        employee_hierarchy eh ON e.manager_id = eh.employee_id
)
SELECT
    employee_id,
    first_name,
    last_name,
    level,
    hierarchy_path
FROM
    employee_hierarchy
ORDER BY
    level, first_name;
        </textarea>
      </div>

      <h3>Views</h3>
      <p>A view is a virtual table based on the result set of a SELECT statement. Views can simplify complex queries, enhance security, and provide data independence.</p>

      <div class="code-container">
        <textarea class="code-area" rows="25" readonly>
-- Creating a view
CREATE VIEW employee_details AS
SELECT
    e.employee_id,
    e.first_name,
    e.last_name,
    e.email,
    d.dept_name,
    e.salary
FROM
    employees e
JOIN
    departments d ON e.dept_id = d.dept_id;

-- Using a view like a regular table
SELECT * FROM employee_details WHERE dept_name = 'Finance';

-- Creating a view with computed columns
CREATE VIEW employee_annual_compensation AS
SELECT
    employee_id,
    first_name,
    last_name,
    salary,
    salary * 0.1 as bonus,
    salary * 12 as annual_salary,
    (salary * 12) + (salary * 0.1) as total_compensation
FROM
    employees;

-- Updatable view (not all views are updatable)
CREATE VIEW active_employees AS
SELECT * FROM employees WHERE status = 'Active';

-- We can update this view (and the underlying table)
UPDATE active_employees SET salary = salary * 1.05 WHERE dept_id = 100;
        </textarea>
      </div>

      <h3>Stored Procedures</h3>
      <p>Stored procedures are prepared SQL code that you can save and reuse. They can accept parameters and execute complex operations.</p>
      <p><em>Note: Syntax varies between database systems.</em></p>

      <div class="code-container">
        <textarea class="code-area" rows="40" readonly>
-- PostgreSQL/MySQL stored procedure example
DELIMITER //
CREATE PROCEDURE hire_employee(
    IN p_first_name VARCHAR(50),
    IN p_last_name VARCHAR(50),
    IN p_email VARCHAR(100),
    IN p_dept_id INT,
    IN p_salary DECIMAL(10, 2)
)
BEGIN
    -- Validate input
    IF p_salary < 0 THEN
        SIGNAL SQLSTATE '45000'
        SET MESSAGE_TEXT = 'Salary cannot be negative';
    END IF;

    -- Insert new employee
    INSERT INTO employees (
        first_name,
        last_name,
        email,
        dept_id,
        salary,
        hire_date
    ) VALUES (
        p_first_name,
        p_last_name,
        p_email,
        p_dept_id,
        p_salary,
        CURRENT_DATE
    );

    -- Log the action
    INSERT INTO employee_audit_log (
        action,
        description,
        created_at
    ) VALUES (
        'INSERT',
        CONCAT('New employee hired: ', p_first_name, ' ', p_last_name),
        NOW()
    );

    -- Return the new employee id
    SELECT LAST_INSERT_ID() AS new_employee_id;
END //
DELIMITER ;

-- Calling the stored procedure
CALL hire_employee('John', 'Smith', 'john.smith@example.com', 101, 65000.00);

-- SQL Server stored procedure example
CREATE PROCEDURE generate_department_report
    @dept_id INT,
    @report_date DATE = NULL  -- Optional parameter with default value
AS
BEGIN
    -- Set default date if not provided
    IF @report_date IS NULL
        SET @report_date = GETDATE();

    -- Get department details
    SELECT
        d.dept_name,
        @report_date as report_date,
        COUNT(e.employee_id) as employee_count,
        AVG(e.salary) as avg_salary,
        MIN(e.salary) as min_salary,
        MAX(e.salary) as max_salary,
        SUM(e.salary) as total_salary_expense
    FROM
        departments d
    LEFT JOIN
        employees e ON d.dept_id = e.dept_id
    WHERE
        d.dept_id = @dept_id
    GROUP BY
        d.dept_name;
END;

-- Execute the procedure
EXEC generate_department_report @dept_id = 101;
EXEC generate_department_report @dept_id = 102, @report_date = '2023-01-01';
        </textarea>
      </div>

      <h3>Triggers</h3>
      <p>Triggers are special stored procedures that automatically execute when an event (like INSERT, UPDATE, or DELETE) occurs in a database.</p>

      <div class="code-container">
        <textarea class="code-area" rows="35" readonly>
-- MySQL trigger example: Audit trail for employee salary changes
DELIMITER //
CREATE TRIGGER employee_salary_audit
AFTER UPDATE ON employees
FOR EACH ROW
BEGIN
    IF OLD.salary != NEW.salary THEN
        INSERT INTO salary_changes (
            employee_id,
            old_salary,
            new_salary,
            change_amount,
            change_percent,
            changed_by,
            change_date
        ) VALUES (
            NEW.employee_id,
            OLD.salary,
            NEW.salary,
            NEW.salary - OLD.salary,
            ((NEW.salary - OLD.salary) / OLD.salary) * 100,
            CURRENT_USER(),
            NOW()
        );
    END IF;
END //
DELIMITER ;

-- PostgreSQL trigger example: Maintain updated_at timestamp
CREATE OR REPLACE FUNCTION update_modified_column()
RETURNS TRIGGER AS $$
BEGIN
    NEW.updated_at = NOW();
    RETURN NEW;
END;
$$ LANGUAGE plpgsql;

CREATE TRIGGER update_customer_modtime
BEFORE UPDATE ON customers
FOR EACH ROW
EXECUTE FUNCTION update_modified_column();

-- SQL Server trigger example: Prevent deletions during business hours
CREATE TRIGGER prevent_business_hours_deletion
ON employees
FOR DELETE
AS
BEGIN
    DECLARE @current_time TIME = CAST(GETDATE() AS TIME);
    DECLARE @business_start TIME = '09:00:00';
    DECLARE @business_end TIME = '17:00:00';
    DECLARE @weekend BIT = CASE WHEN DATEPART(WEEKDAY, GETDATE()) IN (1, 7) THEN 1 ELSE 0 END;

    IF @weekend = 0 AND @current_time BETWEEN @business_start AND @business_end
    BEGIN
        ROLLBACK TRANSACTION;
        THROW 50000, 'Employees cannot be deleted during business hours (9 AM - 5 PM, Mon-Fri).', 1;
    END;
END;
        </textarea>
      </div>

      <h3>Transactions</h3>
      <p>Transactions allow you to execute a series of SQL statements as a single unit of work, ensuring data integrity. They follow the ACID properties: Atomicity, Consistency, Isolation, and Durability.</p>

      <div class="code-container">
        <textarea class="code-area" rows="30" readonly>
-- Basic transaction structure
BEGIN TRANSACTION;  -- Start the transaction

-- Multiple SQL operations
UPDATE accounts SET balance = balance - 500 WHERE account_id = 123;
UPDATE accounts SET balance = balance + 500 WHERE account_id = 456;

-- Check for errors
IF @@ERROR = 0  -- SQL Server syntax; varies by database
    COMMIT TRANSACTION;  -- All changes are saved
ELSE
    ROLLBACK TRANSACTION;  -- All changes are discarded

-- MySQL/PostgreSQL transaction example
START TRANSACTION;

-- Transfer money between accounts
UPDATE accounts SET balance = balance - 1000 WHERE account_id = 1;

-- Check if the first account has sufficient funds
SELECT @balance := balance FROM accounts WHERE account_id = 1;
IF @balance < 0 THEN
    ROLLBACK;
    SELECT 'Transaction cancelled: Insufficient funds';
ELSE
    -- Continue with the transfer
    UPDATE accounts SET balance = balance + 1000 WHERE account_id = 2;

    -- Insert transaction record
    INSERT INTO transactions (from_account, to_account, amount, transaction_date)
    VALUES (1, 2, 1000, NOW());

    COMMIT;
    SELECT 'Transaction completed successfully';
END IF;

-- Transaction isolation levels
-- Controls how concurrent transactions interact
SET TRANSACTION ISOLATION LEVEL READ COMMITTED;
-- Common levels: READ UNCOMMITTED, READ COMMITTED, REPEATABLE READ, SERIALIZABLE
        </textarea>
      </div>

      <h3>Window Functions</h3>
      <p>Window functions perform calculations across a set of rows related to the current row, without grouping the rows into a single output row.</p>

      <div class="code-container">
        <textarea class="code-area" rows="35" readonly>
-- Basic window function syntax
SELECT
    column1,
    column2,
    window_function() OVER ([PARTITION BY column] [ORDER BY column] [frame_clause])
FROM
    table;

-- Example: Ranking employees by salary within each department
SELECT
    employee_id,
    first_name,
    last_name,
    dept_id,
    salary,
    RANK() OVER (PARTITION BY dept_id ORDER BY salary DESC) as dept_salary_rank,
    DENSE_RANK() OVER (PARTITION BY dept_id ORDER BY salary DESC) as dept_salary_dense_rank,
    ROW_NUMBER() OVER (PARTITION BY dept_id ORDER BY salary DESC) as dept_salary_row_num
FROM
    employees;

-- Common window functions
-- Running total of sales by month
SELECT
    sale_date,
    amount,
    SUM(amount) OVER (ORDER BY sale_date) as running_total
FROM
    sales;

-- Moving average (last 3 months' sales)
SELECT
    sale_month,
    monthly_sales,
    AVG(monthly_sales) OVER (
        ORDER BY sale_month
        ROWS BETWEEN 2 PRECEDING AND CURRENT ROW
    ) as three_month_moving_avg
FROM
    monthly_sales;

-- Calculating percentiles
SELECT
    employee_id,
    salary,
    NTILE(4) OVER (ORDER BY salary) as salary_quartile,
    PERCENT_RANK() OVER (ORDER BY salary) as salary_percent_rank,
    CUME_DIST() OVER (ORDER BY salary) as salary_cumulative_dist
FROM
    employees;
        </textarea>
      </div>

      <h3>JSON Support</h3>
      <p>Modern databases offer functions to work with JSON data, allowing for flexible schema designs.</p>

      <div class="code-container">
        <textarea class="code-area" rows="25" readonly>
-- PostgreSQL JSON examples
-- Create a table with a JSON column
CREATE TABLE customers (
    customer_id SERIAL PRIMARY KEY,
    info JSONB NOT NULL
);

-- Insert JSON data
INSERT INTO customers (info)
VALUES (
    '{"name": "John Smith", "contact": {"email": "john@example.com", "phone": "555-1234"}, "preferences": ["electronics", "books"]}'
);

-- Query JSON data
-- Extract a specific field
SELECT
    customer_id,
    info->'name' as customer_name,
    info->'contact'->>'email' as email
FROM
    customers;

-- Filter by JSON property
SELECT * FROM customers WHERE info->'name' = '"John Smith"';
SELECT * FROM customers WHERE info->'preferences' ? 'electronics';

-- Update JSON data
UPDATE customers
SET info = jsonb_set(info, '{contact,phone}', '"555-5678"', true)
WHERE customer_id = 1;
        </textarea>
      </div>

      <div class="practice-container">
        <h3>Practice: Subqueries and CTEs</h3>
        <p>Write a query to find employees who earn more than the average salary in their department. Try writing it with both a subquery and a CTE approach.</p>
        <textarea id="sql-subquery-practice" class="practice-area" rows="15" placeholder="Write your SQL query here..."></textarea>
        <button onclick="checkAnswer('sql-subquery-practice')">Check Answer</button>
        <div id="sql-subquery-practice-feedback" class="feedback"></div>
      </div>

      <div class="practice-container">
        <h3>Practice: Window Functions</h3>
        <p>Write a query to rank products by their sales within each category, and include each product's percentage of the total sales in its category.</p>
        <textarea id="sql-window-practice" class="practice-area" rows="15" placeholder="Write your SQL query here..."></textarea>
        <button onclick="checkAnswer('sql-window-practice')">Check Answer</button>
        <div id="sql-window-practice-feedback" class="feedback"></div>
      </div>
    </div>

    <div id="sql-security" class="sql-section" style="display: none;">
      <h2>SQL Security Best Practices</h2>
      <p>SQL security is a critical aspect of database management. Following security best practices helps protect your data from unauthorized access and SQL injection attacks.</p>

      <h3>Understanding SQL Injection</h3>
      <p>SQL injection is a code injection technique where malicious SQL statements are inserted into entry fields for execution:</p>

      <div class="code-container">
        <textarea class="code-area" rows="15" readonly>
-- Vulnerable code (in pseudocode)
query = "SELECT * FROM users WHERE username = '" + username + "' AND password = '" + password + "'";

-- If a user enters the following as username:
-- admin' --
-- The resulting query becomes:
SELECT * FROM users WHERE username = 'admin' --' AND password = 'anything'

-- The -- makes the rest of the query a comment, effectively bypassing password verification
        </textarea>
      </div>

      <h3>Using Parameterized Queries</h3>
      <p>Parameterized queries (prepared statements) are the most effective way to prevent SQL injection:</p>

      <div class="code-container">
        <textarea class="code-area" rows="25" readonly>
-- SQL Server example
DECLARE @sql nvarchar(1000);
DECLARE @username nvarchar(50);
DECLARE @password nvarchar(50);

-- Unsafe approach (vulnerable to SQL injection)
SET @username = 'admin';
SET @password = 'password';
SET @sql = 'SELECT * FROM users WHERE username = ''' + @username + ''' AND password = ''' + @password + '''';
EXEC(@sql);

-- Safe approach using parameterized query
-- In SQL Server
DECLARE @username nvarchar(50) = 'admin';
DECLARE @password nvarchar(50) = 'password';
EXEC sp_executesql N'SELECT * FROM users WHERE username = @u AND password = @p',
  N'@u nvarchar(50), @p nvarchar(50)',
  @u = @username, @p = @password;

-- In application code (examples in different languages)
-- Python with sqlite3:
cursor.execute("SELECT * FROM users WHERE username = ? AND password = ?", (username, password))

-- Java with JDBC:
PreparedStatement stmt = conn.prepareStatement("SELECT * FROM users WHERE username = ? AND password = ?");
stmt.setString(1, username);
stmt.setString(2, password);
ResultSet rs = stmt.executeQuery();
        </textarea>
      </div>

      <h3>Principle of Least Privilege</h3>
      <p>Limit database user permissions to only what is necessary for their function:</p>

      <div class="code-container">
        <textarea class="code-area" rows="20" readonly>
-- Create a user with limited permissions
CREATE USER 'app_user'@'localhost' IDENTIFIED BY 'password';

-- Grant only the necessary permissions
GRANT SELECT, INSERT, UPDATE ON database_name.table_name TO 'app_user'@'localhost';

-- Don't grant administrative privileges to application users
-- AVOID: GRANT ALL PRIVILEGES ON *.* TO 'app_user'@'localhost';

-- Regularly review and revoke unnecessary permissions
SHOW GRANTS FOR 'app_user'@'localhost';
REVOKE INSERT ON database_name.table_name FROM 'app_user'@'localhost';

-- Create different users for different roles
CREATE USER 'read_only_user'@'localhost' IDENTIFIED BY 'password';
GRANT SELECT ON database_name.* TO 'read_only_user'@'localhost';
        </textarea>
      </div>

      <h3>Input Validation</h3>
      <p>Always validate and sanitize user input before using it in SQL queries:</p>

      <div class="code-container">
        <textarea class="code-area" rows="15" readonly>
-- Server-side validation (pseudocode examples)

-- Data type validation
IF NOT ISNUMERIC(@user_id) THEN
    RAISE ERROR 'Invalid input: user_id must be numeric';
END IF;

-- Length validation
IF LENGTH(@username) > 50 THEN
    RAISE ERROR 'Username too long';
END IF;

-- Pattern matching (for emails, etc.)
IF NOT @email ~ '^[A-Za-z0-9._%-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,4}$' THEN
    RAISE ERROR 'Invalid email format';
END IF;
        </textarea>
      </div>

      <h3>Sensitive Data Encryption</h3>
      <p>Encrypt sensitive data in your database to protect it even if unauthorized access occurs:</p>

      <div class="code-container">
        <textarea class="code-area" rows="20" readonly>
-- SQL Server encryption example
-- Create a master key and certificate
CREATE MASTER KEY ENCRYPTION BY PASSWORD = 'ComplexPassword123!';
CREATE CERTIFICATE MyCertificate WITH SUBJECT = 'Data Protection Certificate';

-- Create a symmetric key for data encryption
CREATE SYMMETRIC KEY MySymmetricKey
WITH ALGORITHM = AES_256
ENCRYPTION BY CERTIFICATE MyCertificate;

-- Encrypt data when inserting
OPEN SYMMETRIC KEY MySymmetricKey DECRYPTION BY CERTIFICATE MyCertificate;

INSERT INTO customers (customer_name, credit_card)
VALUES ('John Smith', EncryptByKey(Key_GUID('MySymmetricKey'), '1234-5678-9012-3456'));

-- Decrypt data when selecting
SELECT
    customer_name,
    CONVERT(varchar(50), DecryptByKey(credit_card)) AS decrypted_credit_card
FROM customers;

CLOSE SYMMETRIC KEY MySymmetricKey;
        </textarea>
      </div>

      <h3>Role-Based Access Control (RBAC)</h3>
      <p>Implement role-based access control to manage database permissions more effectively:</p>

      <div class="code-container">
        <textarea class="code-area" rows="25" readonly>
-- PostgreSQL RBAC example
-- Create roles for different user types
CREATE ROLE readonly;
CREATE ROLE dataentry;
CREATE ROLE admin;

-- Assign permissions to roles
GRANT SELECT ON ALL TABLES IN SCHEMA public TO readonly;

GRANT SELECT, INSERT, UPDATE ON table1, table2 TO dataentry;
GRANT SELECT ON table3, table4 TO dataentry;

GRANT ALL PRIVILEGES ON ALL TABLES IN SCHEMA public TO admin;
GRANT ALL PRIVILEGES ON ALL SEQUENCES IN SCHEMA public TO admin;

-- Create users and assign roles
CREATE USER john WITH PASSWORD 'secure_password';
CREATE USER sarah WITH PASSWORD 'another_secure_password';
CREATE USER mike WITH PASSWORD 'admin_secure_password';

-- Assign roles to users
GRANT readonly TO john;
GRANT dataentry TO sarah;
GRANT admin TO mike;

-- Revoke specific permissions if needed
REVOKE DELETE ON sensitive_table FROM dataentry;
        </textarea>
      </div>

      <h3>Database Auditing</h3>
      <p>Implement database auditing to track user activities and detect suspicious behavior:</p>

      <div class="code-container">
        <textarea class="code-area" rows="30" readonly>
-- SQL Server Auditing
-- Create server audit
CREATE SERVER AUDIT Security_Audit
TO FILE (FILEPATH = 'C:\AuditLogs\');

-- Create database audit specification
USE YourDatabase;
CREATE DATABASE AUDIT SPECIFICATION Database_Audit_Spec
FOR SERVER AUDIT Security_Audit
ADD (SELECT, INSERT, UPDATE, DELETE ON DATABASE::YourDatabase BY dbo),
ADD (SCHEMA_OBJECT_ACCESS_GROUP),
ADD (DATABASE_ROLE_MEMBER_CHANGE_GROUP);

-- Enable the audit
ALTER SERVER AUDIT Security_Audit WITH (STATE = ON);
ALTER DATABASE AUDIT SPECIFICATION Database_Audit_Spec WITH (STATE = ON);

-- MySQL Auditing
-- Enable the audit log plugin
SET GLOBAL audit_log_format = JSON;
SET GLOBAL audit_log_file = 'mysql_audit';
SET GLOBAL audit_log_buffer_size = 1048576;
SET GLOBAL audit_log_policy = ALL;

-- Create a trigger to audit sensitive data changes
DELIMITER //
CREATE TRIGGER audit_customer_changes
AFTER UPDATE ON customers
FOR EACH ROW
BEGIN
    INSERT INTO audit_log (
        table_name,
        action,
        field_name,
        old_value,
        new_value,
        user,
        timestamp
    ) VALUES (
        'customers',
        'UPDATE',
        'credit_card',
        OLD.credit_card,
        NEW.credit_card,
        CURRENT_USER(),
        NOW()
    );
END //
DELIMITER ;
        </textarea>
      </div>

      <h3>Secure Schema Design</h3>
      <p>Design your database schema with security in mind:</p>

      <div class="code-container">
        <textarea class="code-area" rows="25" readonly>
-- Schema security best practices

-- 1. Use schemas to segregate data
CREATE SCHEMA public; -- General application data
CREATE SCHEMA reporting; -- Reporting-specific tables
CREATE SCHEMA sensitive; -- Sensitive data with restricted access

-- 2. Avoid storing sensitive data when possible
-- Instead of storing full credit card numbers:
CREATE TABLE payment_methods (
    id INT PRIMARY KEY,
    customer_id INT,
    card_type VARCHAR(20),
    last_four_digits CHAR(4),
    expiration_date DATE,
    FOREIGN KEY (customer_id) REFERENCES customers(id)
);

-- 3. Use proper data types and constraints
CREATE TABLE users (
    id INT PRIMARY KEY,
    username VARCHAR(50) NOT NULL UNIQUE, -- Enforce uniqueness
    email VARCHAR(100) NOT NULL UNIQUE CHECK (email ~* '^[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,}$'),
    password_hash CHAR(60) NOT NULL, -- For bcrypt hashes
    failed_login_attempts SMALLINT DEFAULT 0 CHECK (failed_login_attempts >= 0),
    account_locked BOOLEAN DEFAULT FALSE,
    last_login TIMESTAMP
);
        </textarea>
      </div>

      <h3>Data Masking and Redaction</h3>
      <p>Protect sensitive data by masking or redacting it when displayed to users without appropriate permissions:</p>

      <div class="code-container">
        <textarea class="code-area" rows="30" readonly>
-- SQL Server Dynamic Data Masking
CREATE TABLE customers (
    id INT PRIMARY KEY,
    first_name VARCHAR(50) NOT NULL,
    last_name VARCHAR(50) NOT NULL,
    email VARCHAR(100) MASKED WITH (FUNCTION = 'email()') NOT NULL,
    phone_number VARCHAR(20) MASKED WITH (FUNCTION = 'partial(0, "XXX-XXX-", 4)') NOT NULL,
    social_security VARCHAR(11) MASKED WITH (FUNCTION = 'default()') NOT NULL,
    credit_card VARCHAR(19) MASKED WITH (FUNCTION = 'partial(0, "XXXX-XXXX-XXXX-", 4)') NOT NULL
);

-- Grant unmask permission to specific users
GRANT UNMASK TO finance_admin;

-- Oracle Data Redaction
-- Enable data redaction policy
BEGIN
  DBMS_REDACT.ADD_POLICY(
    object_schema    => 'HR',
    object_name      => 'EMPLOYEES',
    policy_name      => 'REDACT_SALARY',
    column_name      => 'SALARY',
    function_type    => DBMS_REDACT.FULL,
    expression       => 'SYS_CONTEXT(''USERENV'',''SESSION_USER'') != ''HR_MANAGER'''
  );
END;
/

-- PostgreSQL (using views for redaction)
CREATE VIEW redacted_customers AS
SELECT
    id,
    first_name,
    last_name,
    CASE WHEN has_privilege(current_user, 'customer_data_access')
         THEN email
         ELSE SUBSTRING(email, 1, 2) || '****@' || SPLIT_PART(email, '@', 2)
    END AS email,
    CASE WHEN has_privilege(current_user, 'customer_data_access')
         THEN phone_number
         ELSE 'XXX-XXX-' || RIGHT(phone_number, 4)
    END AS phone_number
FROM customers;
        </textarea>
      </div>

      <h3>Database Backups and Recovery</h3>
      <p>Regularly back up your database and test your recovery procedures to ensure data availability and integrity:</p>

      <div class="code-container">
        <textarea class="code-area" rows="25" readonly>
-- SQL Server Backup
-- Full backup
BACKUP DATABASE YourDatabase
TO DISK = 'C:\Backups\YourDatabase_Full.bak'
WITH INIT, -- Overwrite existing backup set
     NAME = 'YourDatabase-Full Database Backup',
     DESCRIPTION = 'Full backup of YourDatabase';

-- Differential backup
BACKUP DATABASE YourDatabase
TO DISK = 'C:\Backups\YourDatabase_Diff.bak'
WITH DIFFERENTIAL,
     NAME = 'YourDatabase-Differential Backup',
     DESCRIPTION = 'Differential backup of YourDatabase';

-- Transaction log backup
BACKUP LOG YourDatabase
TO DISK = 'C:\Backups\YourDatabase_Log.bak'
WITH NAME = 'YourDatabase-Log Backup';

-- PostgreSQL Backup
-- Using pg_dump for a full backup
pg_dump -U username -F c -b -v -f "C:\Backups\database_backup.backup" database_name

-- MySQL Backup
-- Using mysqldump
mysqldump -u root -p --opt database_name > database_backup.sql

-- Set up automated backups (example shell script)
#!/bin/bash
DATE=$(date +%Y-%m-%d)
mysqldump -u username -ppassword database_name | gzip > /backups/database_$DATE.sql.gz
        </textarea>
      </div>

      <h3>Transport Layer Security (TLS/SSL)</h3>
      <p>Encrypt connections between clients and the database server to prevent eavesdropping and man-in-the-middle attacks:</p>

      <div class="code-container">
        <textarea class="code-area" rows="20" readonly>
-- MySQL SSL Configuration
-- In my.cnf file
[mysqld]
ssl-ca=/path/to/ca.pem
ssl-cert=/path/to/server-cert.pem
ssl-key=/path/to/server-key.pem
require_secure_transport=ON

-- Verify SSL is enabled
SHOW VARIABLES LIKE '%ssl%';

-- Require SSL for specific users
CREATE USER 'username'@'%' IDENTIFIED BY 'password' REQUIRE SSL;
ALTER USER 'username'@'%' REQUIRE SSL;

-- PostgreSQL SSL Configuration
-- In postgresql.conf
ssl = on
ssl_cert_file = 'server.crt'
ssl_key_file = 'server.key'
ssl_ca_file = 'root.crt'

-- Force SSL connections in pg_hba.conf
hostssl all all 0.0.0.0/0 md5
        </textarea>
      </div>

      <div class="practice-container">
        <h3>Practice: SQL Injection Prevention</h3>
        <p>Identify and fix the SQL injection vulnerability in the following code:</p>
        <textarea id="sql-security-practice" class="practice-area" rows="15" placeholder="Write your solution here...">
-- Vulnerable code:
query = "SELECT * FROM products WHERE category = '" + userInput + "' ORDER BY name";
        </textarea>
        <button onclick="checkAnswer('sql-security-practice')">Check Answer</button>
        <div id="sql-security-practice-feedback" class="feedback"></div>
      </div>
    </div>
  </div>

  <script>
    // Toggle visibility of sections
    function toggleSection(sectionId) {
      const sections = document.querySelectorAll('.sql-section');

      // Hide all sections
      sections.forEach(section => {
        section.style.display = 'none';
      });

      // Show the selected section
      document.getElementById(sectionId).style.display = 'block';

      // Hide practice problem container when switching sections
      if (document.getElementById('sql-practice-problem-container')) {
        document.getElementById('sql-practice-problem-container').style.display = 'none';
      }
    }

    // Function to check answers
    function checkAnswer(practiceId) {
      console.log("Checking answer for: " + practiceId);

      // Check if solution already exists and is visible
      let solutionId = practiceId + "-solution";
      let solution = document.getElementById(solutionId);

      if (solution) {
        // If solution exists, toggle it
        if (solution.style.display === 'block') {
          solution.style.display = 'none';
          return;
        } else {
          solution.style.display = 'block';
          solution.scrollIntoView({ behavior: 'smooth', block: 'start' });
          return;
        }
      }

      // Get solution content based on practice ID
      let solutionContent = "";

      switch(practiceId) {
        case 'sql-joins-practice':
          solutionContent = `-- Solution using JOINs to find total sales amount for each product category
SELECT
    c.category_id,
    c.category_name,
    SUM(o.quantity * p.price) AS total_sales
FROM
    categories c
JOIN
    products p ON c.category_id = p.category_id
JOIN
    order_items o ON p.product_id = o.product_id
GROUP BY
    c.category_id, c.category_name
ORDER BY
    total_sales DESC;`;
          break;
        case 'sql-self-join-practice':
          solutionContent = `-- Solution using self-JOIN to display employee names with their managers
SELECT
    e.employee_id,
    e.first_name || ' ' || e.last_name AS employee_name,
    m.first_name || ' ' || m.last_name AS manager_name
FROM
    employees e
LEFT JOIN
    employees m ON e.manager_id = m.employee_id
ORDER BY
    e.employee_id;`;
          break;
        case 'sql-subquery-practice':
          solutionContent = `-- Solution with subquery
SELECT
    e.employee_id,
    e.first_name,
    e.last_name,
    e.dept_id,
    e.salary
FROM
    employees e
WHERE
    e.salary > (
        SELECT AVG(salary)
        FROM employees
        WHERE dept_id = e.dept_id
    )
ORDER BY
    e.dept_id, e.salary DESC;

-- Solution with CTE
WITH dept_averages AS (
    SELECT
        dept_id,
        AVG(salary) AS avg_dept_salary
    FROM
        employees
    GROUP BY
        dept_id
)
SELECT
    e.employee_id,
    e.first_name,
    e.last_name,
    e.dept_id,
    e.salary,
    da.avg_dept_salary
FROM
    employees e
JOIN
    dept_averages da ON e.dept_id = da.dept_id
WHERE
    e.salary > da.avg_dept_salary
ORDER BY
    e.dept_id, e.salary DESC;`;
          break;
        case 'sql-window-practice':
          solutionContent = `-- Solution using window functions to rank products by sales within categories
SELECT
    p.product_id,
    p.product_name,
    c.category_name,
    SUM(oi.quantity * p.price) AS product_sales,
    RANK() OVER (
        PARTITION BY p.category_id
        ORDER BY SUM(oi.quantity * p.price) DESC
    ) AS sales_rank,
    SUM(oi.quantity * p.price) / SUM(SUM(oi.quantity * p.price)) OVER (
        PARTITION BY p.category_id
    ) * 100 AS category_sales_percentage
FROM
    products p
JOIN
    categories c ON p.category_id = c.category_id
JOIN
    order_items oi ON p.product_id = oi.product_id
GROUP BY
    p.product_id, p.product_name, c.category_name, p.category_id
ORDER BY
    c.category_name, sales_rank;`;
          break;
        case 'sql-security-practice':
          solutionContent = `-- Vulnerable code:
-- query = "SELECT * FROM products WHERE category = '" + userInput + "' ORDER BY name";

-- Solution using parameterized query:
-- Using prepared statements (Java example)
String query = "SELECT * FROM products WHERE category = ? ORDER BY name";
PreparedStatement stmt = connection.prepareStatement(query);
stmt.setString(1, userInput);
ResultSet results = stmt.executeQuery();

-- PHP PDO example
$query = "SELECT * FROM products WHERE category = :category ORDER BY name";
$stmt = $pdo->prepare($query);
$stmt->execute(['category' => $userInput]);
$results = $stmt->fetchAll();

-- Python with SQLAlchemy example
query = "SELECT * FROM products WHERE category = :category ORDER BY name"
result = session.execute(query, {"category": user_input})

-- Node.js with MySQL example
const query = "SELECT * FROM products WHERE category = ? ORDER BY name";
connection.query(query, [userInput], (error, results) => {
  if (error) throw error;
  console.log(results);
});`;
          break;
        default:
          solutionContent = "No solution available for this practice.";
      }

      // Create solution element with high z-index styling
      solution = document.createElement('div');
      solution.id = solutionId;
      solution.className = 'solution-container';
      solution.style.position = 'relative';
      solution.style.zIndex = '9999';

      // Set HTML with site theme styling
      solution.innerHTML = `
        <div style="
          margin-top: 20px;
          padding: 15px;
          border: 1px solid #444;
          border-radius: 5px;
          background-color: #1a1a1a;
          color: #ddd;
          position: relative;
          z-index: 9999;
        ">
          <h3 style="
            color: #ccc;
            margin-top: 0;
            margin-bottom: 10px;
            font-size: 18px;
            position: relative;
            z-index: 9999;
          ">Solution:</h3>
          <pre style="
            display: block;
            background-color: #111;
            color: #ddd;
            padding: 15px;
            border-radius: 5px;
            white-space: pre-wrap;
            overflow: auto;
            font-family: monospace;
            margin: 0;
            border: 1px solid #333;
            position: relative;
            z-index: 9999;
          ">${solutionContent}</pre>
        </div>
      `;

      // Find the practice textarea
      const textarea = document.getElementById(practiceId);

      // Add solution element after the textarea's parent (the practice-container)
      textarea.parentNode.appendChild(solution);

      // Scroll to solution
      solution.scrollIntoView({ behavior: 'smooth', block: 'start' });

      console.log("Solution displayed for: " + practiceId);
    }

    // Function to load SQL practice problems
    function loadSqlPractice(problemId) {
      // This function is no longer actively used as all practice problems are marked "Coming Soon"
      // A simplified version is kept for future implementation

      // Display a message that practice problems are coming soon
      alert("SQL Practice Problems will be available soon!");
      return;

      /* Original function implementation is commented out for future use
      // Ensure the practice problem container exists
      const container = document.getElementById('sql-practice-problem-container');
      if (!container) {
        console.error("Practice problem container not found");
        return;
      }

      // Show the practice problem container
      container.style.display = 'block';
      container.scrollIntoView({ behavior: 'smooth', block: 'start' });

      // Clear previous content
      document.getElementById('sql-practice-area').value = '';
      document.getElementById('sql-practice-feedback').innerHTML = '';
      if (document.getElementById('sql-practice-hint')) {
        document.getElementById('sql-practice-hint').style.display = 'none';
      }

      // Problem definitions
      const problems = {
        // Basic SQL problems
        'basic-select': {
          title: 'Basic SELECT Queries',
          difficulty: 'Basic',
          description: `Write a SELECT query to retrieve the first name, last name, and email of all customers,
                        sorted alphabetically by last name.`,
          schema: `-- Database Schema
CREATE TABLE customers (
    customer_id INT PRIMARY KEY,
    first_name VARCHAR(50) NOT NULL,
    last_name VARCHAR(50) NOT NULL,
    email VARCHAR(100) NOT NULL UNIQUE,
    phone VARCHAR(20),
    address VARCHAR(200),
    city VARCHAR(50),
    state VARCHAR(2),
    zip_code VARCHAR(10),
    registration_date DATE
);`,
          sampleData: `-- Sample data in customers table
INSERT INTO customers VALUES (1, 'John', 'Smith', 'john.smith@email.com', '555-123-4567', '123 Main St', 'Springfield', 'IL', '62701', '2023-01-15');
INSERT INTO customers VALUES (2, 'Emily', 'Johnson', 'emily.j@email.com', '555-987-6543', '456 Oak Ave', 'Riverside', 'CA', '92501', '2023-02-20');
INSERT INTO customers VALUES (3, 'Michael', 'Brown', 'mbrown@email.com', '555-345-6789', '789 Pine Rd', 'Franklin', 'OH', '45005', '2023-01-05');
INSERT INTO customers VALUES (4, 'Sarah', 'Davis', 'sarah.davis@email.com', '555-678-9012', '101 Cedar Ln', 'Georgetown', 'TX', '78626', '2023-03-10');
INSERT INTO customers VALUES (5, 'David', 'Wilson', 'dwilson@email.com', '555-234-5678', '246 Elm St', 'Springfield', 'IL', '62704', '2023-02-28');`,
          expected: `-- Expected output (5 rows)
first_name | last_name | email
-----------|-----------|------------------------
Michael    | Brown     | mbrown@email.com
Sarah      | Davis     | sarah.davis@email.com
Emily      | Johnson   | emily.j@email.com
John       | Smith     | john.smith@email.com
David      | Wilson    | dwilson@email.com`,
          hint: `For this problem, you need to:
1. Use the SELECT statement to retrieve specific columns
2. Specify the table to query from using FROM
3. Sort the results alphabetically by last_name using ORDER BY`
        },

        // Additional problem definitions can be added here when ready
      };

      // Set problem content based on problemId
      if (problems[problemId]) {
        const problem = problems[problemId];

        // Set basic problem info
        document.getElementById('sql-practice-title').textContent = problem.title;
        document.getElementById('sql-practice-difficulty').textContent = problem.difficulty;
        document.getElementById('sql-practice-description').innerHTML = problem.description;

        // Set schema-related information
        document.getElementById('sql-practice-schema').textContent = problem.schema || 'No schema available';
        document.getElementById('sql-practice-sample-data').textContent = problem.sampleData || 'No sample data available';
        document.getElementById('sql-practice-expected').textContent = problem.expected || 'No expected output available';

        // Set hint if available
        const hintElement = document.getElementById('sql-practice-hint');
        if (hintElement) {
          hintElement.innerHTML = `<h4>Hint:</h4><p>${problem.hint || 'No hint available for this problem.'}</p>`;
          hintElement.style.display = 'none';
        }

        // Optionally set schema diagram if available
        const schemaElement = document.getElementById('schema-diagram');
        schemaElement.innerHTML = problem.schemaDiagram || '<p>No schema diagram available</p>';
      } else {
        // Default message if problem not found
        document.getElementById('sql-practice-title').textContent = "Problem Not Found";
        document.getElementById('sql-practice-difficulty').textContent = "N/A";
        document.getElementById('sql-practice-description').textContent = "The requested problem could not be found.";
        document.getElementById('sql-practice-schema').textContent = "";
        document.getElementById('sql-practice-sample-data').textContent = "";
        document.getElementById('sql-practice-expected').textContent = "";
      }
      */
    }

    function checkSqlSolution() {
      const problemTitle = document.getElementById('sql-practice-title').textContent;
      const userSQL = document.getElementById('sql-practice-area').value.trim().toLowerCase();
      const feedbackElement = document.getElementById('sql-practice-feedback');

      // Clear previous feedback
      feedbackElement.innerHTML = '';

      // Check the solution based on the current problem
      let feedbackHtml = '';

      if (problemTitle === 'Basic SELECT Queries') {
        if (userSQL.includes('select') &&
            userSQL.includes('first_name') &&
            userSQL.includes('last_name') &&
            userSQL.includes('email') &&
            userSQL.includes('from customers') &&
            userSQL.includes('order by last_name')) {
          feedbackHtml = `<div class="success">
            <p>Great job! Your solution looks good. Here's a sample solution:</p>
            <pre>
SELECT first_name, last_name, email
FROM customers
ORDER BY last_name;
            </pre>
          </div>`;
        } else {
          feedbackHtml = `<div class="error">
            <p>Your solution doesn't seem complete. Make sure to:</p>
            <ul>
              <li>Select first_name, last_name, and email columns</li>
              <li>Query from the customers table</li>
              <li>Order the results by last_name</li>
            </ul>
          </div>`;
        }
      } else if (problemTitle === 'WHERE Clause Filters') {
        if (userSQL.includes('select') &&
            userSQL.includes('from products') &&
            (userSQL.includes('join categories') || userSQL.includes('inner join categories')) &&
            userSQL.includes('where') &&
            userSQL.includes('price > 50') &&
            (userSQL.includes("category_name = 'electronics'") || userSQL.includes("category_name = \"electronics\""))) {
          feedbackHtml = `<div class="success">
            <p>Great job! Your solution looks good. Here's a sample solution:</p>
            <pre>
SELECT p.*
FROM products p
JOIN categories c ON p.category_id = c.category_id
WHERE p.price > 50
AND c.category_name = 'Electronics';
            </pre>
          </div>`;
        } else {
          feedbackHtml = `<div class="error">
            <p>Your solution doesn't seem complete. Make sure to:</p>
            <ul>
              <li>Join the products and categories tables</li>
              <li>Filter for products with price > 50</li>
              <li>Filter for products in the 'Electronics' category</li>
            </ul>
          </div>`;
        }
      } else {
        feedbackHtml = `<div class="info">
          <p>This practice problem's solution checker hasn't been fully implemented yet. Here's a general guideline:</p>
          <ul>
            <li>Make sure your query syntax is correct</li>
            <li>Check that you're selecting all required columns or calculating required values</li>
            <li>Verify any JOIN conditions are appropriate</li>
            <li>Ensure your WHERE clause correctly filters the data</li>
          </ul>
        </div>`;
      }

      feedbackElement.innerHTML = feedbackHtml;
    }

    // Function to handle practice category switching
    function showPracticeCategory(category) {
      // Hide all categories
      const categories = document.querySelectorAll('.practice-category');
      categories.forEach(cat => {
        cat.style.display = 'none';
      });

      // Show the selected category
      document.getElementById(category + '-practice').style.display = 'block';

      // Hide the practice problem container
      if (document.getElementById('sql-practice-problem-container')) {
        document.getElementById('sql-practice-problem-container').style.display = 'none';
      }

      // Update active button state
      const buttons = document.querySelectorAll('.practice-navigation button');
      buttons.forEach(button => {
        button.classList.remove('active');
        if (button.innerText.toLowerCase().includes(category.toLowerCase())) {
          button.classList.add('active');
        }
      });
    }

    // Function to switch between schema tabs
    function switchTab(tabId) {
      // Hide all tab contents
      const tabContents = document.querySelectorAll('.tab-content');
      tabContents.forEach(tab => {
        tab.classList.remove('active');
      });

      // Show the selected tab content
      document.getElementById(tabId).classList.add('active');

      // Update active tab button state
      const tabButtons = document.querySelectorAll('.tab-button');
      tabButtons.forEach(button => {
        button.classList.remove('active');
        if (button.getAttribute('onclick').includes(tabId)) {
          button.classList.add('active');
        }
      });
    }

    // Function to show hints
    function showHint() {
      const hintBox = document.getElementById('sql-practice-hint');

      if (hintBox.style.display === 'none' || hintBox.style.display === '') {
        hintBox.style.display = 'block';
        // Scroll to hint
        hintBox.scrollIntoView({ behavior: 'smooth', block: 'start' });
      } else {
        hintBox.style.display = 'none';
      }
    }

    // Function to reset solution
    function resetSolution() {
      document.getElementById('sql-practice-area').value = '';
      document.getElementById('sql-practice-feedback').innerHTML = '';
      document.getElementById('sql-practice-hint').style.display = 'none';
    }

    // Initialize the page
    window.onload = function() {
      // Show the first section by default
      document.getElementById('sql-intro').style.display = 'block';

      // Show basic practice category by default
      document.getElementById('basic-practice').style.display = 'block';

      // Prevent clicking on coming soon links
      document.querySelectorAll('.coming-soon').forEach(link => {
        link.addEventListener('click', function(e) {
          e.preventDefault();
          // Optionally show a message
          const feedbackDiv = document.createElement('div');
          feedbackDiv.className = 'info';
          feedbackDiv.innerHTML = '<p>This practice problem will be available soon!</p>';

          // Find the closest practice category and append the message
          const category = this.closest('.practice-category');

          // Remove any existing messages
          const existingMessages = category.querySelectorAll('.info');
          existingMessages.forEach(msg => msg.remove());

          // Add the new message
          category.appendChild(feedbackDiv);

          // Remove the message after 3 seconds
          setTimeout(() => {
            feedbackDiv.remove();
          }, 3000);
        });
      });
    };
  </script>

  <style>
    /* Add CSS for the practice section */
    .practice-navigation {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin: 20px 0;
    }

    .practice-navigation button {
      padding: 8px 16px;
      background-color: #333;
      color: #fff;
      border: 1px solid #444;
      border-radius: 4px;
      cursor: pointer;
      transition: background-color 0.3s;
    }

    .practice-navigation button:hover,
    .practice-navigation button.active {
      background-color: #555;
    }

    .practice-category {
      margin-bottom: 30px;
      padding: 15px;
      background-color: #222;
      border-radius: 5px;
      border: 1px solid #333;
    }

    .practice-list {
      list-style-type: none;
      padding: 0;
    }

    .practice-list li {
      margin: 10px 0;
    }

    .practice-list a {
      color: #4d94ff;
      text-decoration: none;
      padding: 5px 0;
      display: block;
    }

    .practice-list a:hover {
      color: #80b3ff;
      text-decoration: underline;
    }

    /* Style for coming soon links */
    .coming-soon {
      color: #666 !important;
      cursor: default;
      position: relative;
      opacity: 0.7;
      text-decoration: none !important;
    }

    .coming-soon:hover {
      color: #666 !important;
    }

    .coming-soon::after {
      content: "";
      position: absolute;
      top: 50%;
      right: 10px;
      width: 8px;
      height: 8px;
      background-color: #555;
      border-radius: 50%;
      transform: translateY(-50%);
    }

    .practice-problem-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 15px;
    }

    .difficulty-badge {
      padding: 5px 10px;
      border-radius: 4px;
      font-size: 0.8em;
      font-weight: bold;
    }

    .difficulty-badge:contains("Basic") {
      background-color: #285928;
      color: #9eff9e;
    }

    .difficulty-badge:contains("Intermediate") {
      background-color: #525200;
      color: #ffff9e;
    }

    .difficulty-badge:contains("Advanced") {
      background-color: #5e2222;
      color: #ffb3b3;
    }

    .schema-container {
      margin: 20px 0;
      padding: 15px;
      background-color: #111;
      border-radius: 5px;
      border: 1px solid #333;
    }

    .schema-diagram {
      margin-bottom: 15px;
      min-height: 50px;
    }

    .tabs {
      display: flex;
      margin-bottom: 15px;
      border-bottom: 1px solid #333;
    }

    .tab-button {
      padding: 8px 16px;
      background-color: #222;
      border: none;
      color: #aaa;
      cursor: pointer;
    }

    .tab-button.active {
      background-color: #333;
      color: #fff;
      border-bottom: 2px solid #4d94ff;
    }

    .tab-content {
      display: none;
      padding: 10px;
      background-color: #111;
      border-radius: 0 0 5px 5px;
    }

    .tab-content.active {
      display: block;
    }

    .code-display {
      font-family: monospace;
      overflow-x: auto;
      white-space: pre;
      margin: 0;
      padding: 10px;
      color: #ccc;
    }

    .editor-container {
      margin: 20px 0;
    }

    .practice-area {
      width: 100%;
      min-height: 120px;
      padding: 10px;
      font-family: monospace;
      background-color: #111;
      color: #eee;
      border: 1px solid #333;
      border-radius: 5px;
      resize: vertical;
    }

    .button-group {
      display: flex;
      gap: 10px;
      margin-top: 10px;
    }

    .primary-button {
      padding: 8px 16px;
      background-color: #2a5885;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }

    .secondary-button {
      padding: 8px 16px;
      background-color: #333;
      color: white;
      border: 1px solid #444;
      border-radius: 4px;
      cursor: pointer;
    }

    .hint-box {
      margin: 20px 0;
      padding: 15px;
      background-color: #2d2d1d;
      border-left: 4px solid #a99e3c;
      border-radius: 0 5px 5px 0;
    }

    .feedback {
      margin: 20px 0;
    }

    .success {
      padding: 15px;
      background-color: #1a3a1a;
      border-left: 4px solid #4caf50;
      border-radius: 0 5px 5px 0;
    }

    .error {
      padding: 15px;
      background-color: #3a1a1a;
      border-left: 4px solid #f44336;
      border-radius: 0 5px 5px 0;
    }

    .info {
      padding: 15px;
      background-color: #1a2a3a;
      border-left: 4px solid #2196f3;
      border-radius: 0 5px 5px 0;
    }
  </style>
</body>
</html>